image: maven:3-openjdk-18-slim

stages:
    - build
    - test
workflow:
    rules:
        - if: $CI_PIPELINE_SOURCE == 'merge_request_event'

build:
    stage: build
    script: "mvn install -B"
test:
    stage: test
    script: "mvn test"
    coverage: '/Code coverage: \d+\.\d+/'
    artifacts:
        when: always
        reports:
            junit:
                - target/surefire-reports/TEST-*.xml
                - target/failsafe-reports/TEST-*.xml